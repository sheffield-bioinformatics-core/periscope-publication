ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="line",xmin="27046",xmax="27046",ymin=0,ymax=1)
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="path",xmin="27046",xmax="27046",ymin=0,ymax=1)
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="rect",xmin="27046",xmax="27046",ymin=0,ymax=1)
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="rect",xmin="27046",xmax="27213",ymin=0,ymax=1)
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="rect",xmin="27046",xmax="27213",ymin=0,ymax=1,fill=NA)
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="rect",xmin="27046",xmax="27213",ymin=0,ymax=1,fill=NA,color="black")
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="rect",xmin="27046",xmax="27213",ymin=0,ymax=1,fill=NA,color="black",hjust=0.1)
?annotate
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="rect",xmin="27046",xmax="27213",ymin=0,ymax=1,fill=NA,color="black",hjust=0.1,position=position_nudge())
?annotate
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="rect",xmin="27046",xmax="27213",ymin=0,ymax=1,fill=NA,color="black",hjust=0.1,position="dodge")
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="tile",xmin="27046",xmax="27213",ymin=0,ymax=1,fill=NA,color="black")
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="tile",x="27046",y=1,fill=NA,color="black")
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="tile",x="27046",y=0.5,fill=NA,color="black")
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="tile",x="27046",y=0.5,fill=NA,color="black",size=2)
ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="tile",x="27046",y=0.5,fill=NA,color="black",size=1)
setwd("/home/md1mpar/Documents/projects/periscope/genome_research_revision/summary_data")
#==============================
# all varinats plot
#==============================
variants=read.table("supplementary_file_16_base_counts.csv",sep=",",header=T)
positions=variants %>% filter(!is.na(value)) %>% filter(variable %in% c("sgRNA_HQ")) %>% group_by(position,value)
variants_f=variants%>%filter(position %in% positions$position)
variants_f$variable = str_replace(variants_f$variable,"sgRNA_HQ","Sub-genomic RNA (HQ)")
variants_f$variable = str_replace(variants_f$variable,"gRNA","Genomic RNA")
variants_f = na.omit(variants_f%>%filter(position>1000)%>%filter(variable %in% c("Genomic RNA","Sub-genomic RNA (HQ)")))
variants_f$position=as.factor(variants_f$position)
a = ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="tile",x="27046",y=0.5,fill=NA,color="black",size=1)+
annotate(geom="tile",x="28256",y=0.5,fill=NA,color="black",size=1)
sg = read.csv("supplementary_file_1_cannonical_orf_counts.csv")
n_variant_m=melt(sg%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf!="ORF1a")%>%filter(!is.na(sgRPHT_HQ))%>%mutate(color=ifelse(sample %in% c("SHEF-C81D4","SHEF-C2DB8","SHEF-CD6EF","SHEF-C49C1","SHEF-CEA6A","SHEF-C0C35","SHEF-CD6EF","SHEF-C3BF9","SHEF-C04C4","SHEF-BFEE8"),"True","False"))%>%mutate(HQ_LQ=sgRPTg_HQ+sgRPTg_LQ)%>%select(sample,orf,color,HQ_LQ))
e = ggplot(n_variant_m%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf=="ORF6"),aes(color,value))+
geom_boxplot(outlier.shape = NA,aes(color=color))+
geom_jitter(height = 0,aes(color=color),alpha=0.3)+
ft_theme()+
scale_y_continuous("sgRPTg (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,1000,10000))+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "None",
strip.text.x = element_text(face = "bold"),
axis.text.x=element_text(angle=90,hjust=1,vjust=0.1)
)+
scale_color_manual("Quality",values=c(navy,coral,green))+
scale_x_discrete("27046 Variant\nStatus")
n_variant_m=melt(sg%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf!="ORF1a")%>%filter(!is.na(sgRPHT_HQ))%>%mutate(color=ifelse(sample %in% c("SHEF-C0C35"),"True","False"))%>%mutate(HQ_LQ=sgRPTg_HQ+sgRPTg_LQ)%>%select(sample,orf,color,HQ_LQ))
c = ggplot(n_variant_m%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf=="ORF6"),aes(color,value))+
geom_boxplot(outlier.shape = NA,aes(color=color))+
geom_jitter(height = 0,aes(color=color),alpha=0.3)+
ft_theme()+
scale_y_continuous("sgRPTg (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,1000,10000))+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "None",
strip.text.x = element_text(face = "bold"),
axis.text.x=element_text(angle=90,hjust=1,vjust=0.1)
)+
scale_color_manual("Quality",values=c(navy,coral,green))+
scale_x_discrete("28256 Variant\nStatus")
#==============================
# Get images from file
#==============================
two_seven <- readPNG("images/figure_5_variant_27046.png")
two_seven = ggplot() +
background_image(two_seven) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
two_eight <- readPNG("images/figure_5_variant_28256.png")
two_eight = ggplot() +
background_image(two_eight) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
row2=ggarrange(two_eight,c,labels=c("B","C"),nrow=1,widths = c(1,0.4))
row3=ggarrange(two_seven,e,labels=c("D","E"),nrow=1,widths = c(1,0.4))
ggarrange(a,row2,row3,labels=c("A","",""),nrow=3,heights=c(1,0.9,0.9))
setwd("/home/md1mpar/Documents/projects/periscope/genome_research_revision/summary_data")
#==============================
# all varinats plot
#==============================
variants=read.table("supplementary_file_16_base_counts.csv",sep=",",header=T)
positions=variants %>% filter(!is.na(value)) %>% filter(variable %in% c("sgRNA_HQ")) %>% group_by(position,value)
variants_f=variants%>%filter(position %in% positions$position)
variants_f$variable = str_replace(variants_f$variable,"sgRNA_HQ","Sub-genomic RNA (HQ)")
variants_f$variable = str_replace(variants_f$variable,"gRNA","Genomic RNA")
variants_f = na.omit(variants_f%>%filter(position>1000)%>%filter(variable %in% c("Genomic RNA","Sub-genomic RNA (HQ)")))
variants_f$position=as.factor(variants_f$position)
a = ggplot(variants_f,aes(position,value,color=base,fill=base))+
geom_bar(stat="identity",position="fill")+
scale_y_continuous("Proportion of bases in\nall samples with variant")+
ft_theme()+
scale_fill_manual("Base",values=c(green,navy,orange,coral))+
scale_x_discrete("Position (>1000)")+
annotate(geom = "rect",xmin="27046",xmax="27046",ymin=0,ymax=1)+
scale_color_manual("Base",values=c(green,navy,orange,coral))+
facet_wrap(~variable,ncol=1,nrow = 2,shrink=T,drop = T)+
theme(axis.text.x = element_text(angle=45,hjust=1,size=8,face=colorado(variants_f$position,c("27046","28256"))),
axis.title.x = element_text(margin=margin(t=5,r=0,b=5,l=0,unit="pt")),
strip.text.x = element_text(face = "bold",hjust=0,color="#4D4845"),
legend.position = "bottom",
legend.justification = "center"
)+
coord_cartesian(clip="off")+
annotate(geom="tile",x="27046",y=0.5,fill=NA,color="white",size=1)+
annotate(geom="tile",x="28256",y=0.5,fill=NA,color="white",size=1)
sg = read.csv("supplementary_file_1_cannonical_orf_counts.csv")
n_variant_m=melt(sg%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf!="ORF1a")%>%filter(!is.na(sgRPHT_HQ))%>%mutate(color=ifelse(sample %in% c("SHEF-C81D4","SHEF-C2DB8","SHEF-CD6EF","SHEF-C49C1","SHEF-CEA6A","SHEF-C0C35","SHEF-CD6EF","SHEF-C3BF9","SHEF-C04C4","SHEF-BFEE8"),"True","False"))%>%mutate(HQ_LQ=sgRPTg_HQ+sgRPTg_LQ)%>%select(sample,orf,color,HQ_LQ))
e = ggplot(n_variant_m%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf=="ORF6"),aes(color,value))+
geom_boxplot(outlier.shape = NA,aes(color=color))+
geom_jitter(height = 0,aes(color=color),alpha=0.3)+
ft_theme()+
scale_y_continuous("sgRPTg (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,1000,10000))+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "None",
strip.text.x = element_text(face = "bold"),
axis.text.x=element_text(angle=90,hjust=1,vjust=0.1)
)+
scale_color_manual("Quality",values=c(navy,coral,green))+
scale_x_discrete("27046 Variant\nStatus")
n_variant_m=melt(sg%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf!="ORF1a")%>%filter(!is.na(sgRPHT_HQ))%>%mutate(color=ifelse(sample %in% c("SHEF-C0C35"),"True","False"))%>%mutate(HQ_LQ=sgRPTg_HQ+sgRPTg_LQ)%>%select(sample,orf,color,HQ_LQ))
c = ggplot(n_variant_m%>%filter(orf!="ORF1a")%>%filter(orf!="N*")%>%filter(orf=="ORF6"),aes(color,value))+
geom_boxplot(outlier.shape = NA,aes(color=color))+
geom_jitter(height = 0,aes(color=color),alpha=0.3)+
ft_theme()+
scale_y_continuous("sgRPTg (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,1000,10000))+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "None",
strip.text.x = element_text(face = "bold"),
axis.text.x=element_text(angle=90,hjust=1,vjust=0.1)
)+
scale_color_manual("Quality",values=c(navy,coral,green))+
scale_x_discrete("28256 Variant\nStatus")
#==============================
# Get images from file
#==============================
two_seven <- readPNG("images/figure_5_variant_27046.png")
two_seven = ggplot() +
background_image(two_seven) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
two_eight <- readPNG("images/figure_5_variant_28256.png")
two_eight = ggplot() +
background_image(two_eight) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
row2=ggarrange(two_eight,c,labels=c("B","C"),nrow=1,widths = c(1,0.4))
row3=ggarrange(two_seven,e,labels=c("D","E"),nrow=1,widths = c(1,0.4))
ggarrange(a,row2,row3,labels=c("A","",""),nrow=3,heights=c(1,0.9,0.9))
ggplot(all,aes(time,sum_norm,group=class,color=class))+
geom_point()+
geom_line()+
facet_grid(virus~line)+
ft_theme()+
scale_y_continuous("Scaled Normalised\nTotal sgRNA",breaks=c(0,0.5,1))+
scale_x_discrete("Time (h)")+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "bottom",
panel.spacing.x=unit(0.1, "lines"),
strip.text.x = element_text(face = "bold",colour = '#4D4845',size=8),
strip.text.y = element_text(face = "bold",colour = '#4D4845',size=8)
)+scale_color_manual("Data",values=c(orange,navy))
ggplot(cell_ont %>% filter(orf!='ORF1a') %>% filter(orf!='ORF10') %>% filter(orf!='N*'),aes(time,sgRPHT_HQ+sgRPHT_LQ,group=orf,color=orf))+
geom_point()+
geom_line()+
facet_grid(virus~line)+
ggtitle("ONT ARTIC")+
ft_theme()+
scale_y_continuous("Sum of Normalised\nsgRNA (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,300))+
scale_x_discrete("Time (h)")+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "none",
panel.spacing.x=unit(0.1, "lines"),
plot.title = element_text(hjust = 0.5,colour = '#4D4845', size=10 ),
strip.text.y = element_text(face = "bold",colour = '#4D4845', size=8),
strip.text.x = element_text(face = "bold",colour = '#4D4845', size=8)
)+
scale_color_manual("ORF",values=c(navy,coral,orange,yellow,purple,aqua,green,grey,"black"))
ggplot(cell_ont %>% filter(orf=='N') %>% filter(orf!='ORF10') %>% filter(orf!='N*'),aes(time,sgRPHT_HQ+sgRPHT_LQ,group=orf,color=orf))+
geom_point()+
geom_line()+
facet_grid(virus~line)+
ggtitle("ONT ARTIC")+
ft_theme()+
scale_y_continuous("Sum of Normalised\nsgRNA (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,300))+
scale_x_discrete("Time (h)")+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "none",
panel.spacing.x=unit(0.1, "lines"),
plot.title = element_text(hjust = 0.5,colour = '#4D4845', size=10 ),
strip.text.y = element_text(face = "bold",colour = '#4D4845', size=8),
strip.text.x = element_text(face = "bold",colour = '#4D4845', size=8)
)+
scale_color_manual("ORF",values=c(navy,coral,orange,yellow,purple,aqua,green,grey,"black"))
ggplot(cell_illumina %>% filter(orf!='ORF1a') %>% filter(orf!='ORF10') %>% filter(orf!="N*"), aes(time,sgRPHT,group=orf,color=orf))+
geom_point()+
geom_line()+
ggtitle("Illumina Metagenomic")+
facet_grid(virus~line)+
ft_theme()+
scale_y_continuous("Sum of Normalised\nsgRNA (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,3000))+
scale_x_discrete("Time (h)")+
theme(
panel.background=element_rect(fill="grey97",color="white"),
plot.title = element_text(hjust = 0.5,colour = '#4D4845', size=10 ),
legend.justification = "center",
legend.position="bottom",
panel.spacing.x=unit(0.1, "lines"),
strip.text.y = element_text(face = "bold",colour = '#4D4845', size=8),
strip.text.x = element_text(face = "bold",colour = '#4D4845', size=8)
)+
scale_color_manual("ORF",values=c(navy,coral,orange,yellow,purple,aqua,green,grey,"black"))
ggplot(cell_illumina %>% filter(orf!='ORF1a') %>% filter(orf=='N') %>% filter(orf!="N*"), aes(time,sgRPHT,group=orf,color=orf))+
geom_point()+
geom_line()+
ggtitle("Illumina Metagenomic")+
facet_grid(virus~line)+
ft_theme()+
scale_y_continuous("Sum of Normalised\nsgRNA (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,3000))+
scale_x_discrete("Time (h)")+
theme(
panel.background=element_rect(fill="grey97",color="white"),
plot.title = element_text(hjust = 0.5,colour = '#4D4845', size=10 ),
legend.justification = "center",
legend.position="bottom",
panel.spacing.x=unit(0.1, "lines"),
strip.text.y = element_text(face = "bold",colour = '#4D4845', size=8),
strip.text.x = element_text(face = "bold",colour = '#4D4845', size=8)
)+
scale_color_manual("ORF",values=c(navy,coral,orange,yellow,purple,aqua,green,grey,"black"))
ggplot(cell_illumina %>% filter(orf!='ORF1a') %>% filter(orf!='ORF10') %>% filter(orf!="N*"), aes(time,sgRPHT,group=orf,color=orf))+
geom_point()+
geom_line()+
ggtitle("Illumina Metagenomic")+
facet_grid(virus~line)+
ft_theme()+
scale_y_continuous("Sum of Normalised\nsgRNA (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,3000))+
scale_x_discrete("Time (h)")+
theme(
panel.background=element_rect(fill="grey97",color="white"),
plot.title = element_text(hjust = 0.5,colour = '#4D4845', size=10 ),
legend.justification = "center",
legend.position="bottom",
panel.spacing.x=unit(0.1, "lines"),
strip.text.y = element_text(face = "bold",colour = '#4D4845', size=8),
strip.text.x = element_text(face = "bold",colour = '#4D4845', size=8)
)+
scale_color_manual("ORF",values=c(navy,coral,orange,yellow,purple,aqua,green,grey,"black"))
ggplot(cell_ont %>% filter(orf!='ORF1a') %>% filter(orf!='ORF10') %>% filter(orf!='N*'),aes(time,sgRPHT_HQ+sgRPHT_LQ,group=orf,color=orf))+
geom_point()+
geom_line()+
facet_grid(virus~line)+
ggtitle("ONT ARTIC")+
ft_theme()+
scale_y_continuous("Sum of Normalised\nsgRNA (Log10)",trans=scales::pseudo_log_trans(base = 10),breaks=c(0,10,100,300))+
scale_x_discrete("Time (h)")+
theme(
panel.background=element_rect(fill="grey97",color="white"),
legend.position = "none",
panel.spacing.x=unit(0.1, "lines"),
plot.title = element_text(hjust = 0.5,colour = '#4D4845', size=10 ),
strip.text.y = element_text(face = "bold",colour = '#4D4845', size=8),
strip.text.x = element_text(face = "bold",colour = '#4D4845', size=8)
)+
scale_color_manual("ORF",values=c(navy,coral,orange,yellow,purple,aqua,green,grey,"black"))
postcodes=read.csv("/home/md1mpar/Documents/projects/hoci/postcodes.csv")
head(postcodes)
require(rgdal)
require(sp)
require(plotGoogleMaps)
install.packages("rgdal")
require(plotGoogleMaps)
head(postcodes)
