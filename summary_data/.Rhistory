annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(pos)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)+
scale_color_gradient("Number of Samples",low=navy,high=coral)+
annotate(geom="text",label="Illumina Metgenomic",fontface='bold',x=500,y=0.8,color="#4D4845")+
annotate(geom="text",label="ONT ARTIC",fontface='bold',x=500,y=-0.8,color="#4D4845")+
scale_size_continuous("Number of Samples")+facet_grid(virus~line)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)+
scale_color_gradient("Number of Samples",low=navy,high=coral)+
annotate(geom="text",label="Illumina Metgenomic",fontface='bold',x=500,y=0.8,color="#4D4845")+
annotate(geom="text",label="ONT ARTIC",fontface='bold',x=500,y=-0.8,color="#4D4845")+
scale_size_continuous("Number of Samples")+facet_grid(virus~line)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)+
scale_color_gradient("Number of Samples",low=navy,high=coral)+
annotate(geom="text",label="Illumina Metgenomic",fontface='bold',x=500,y=0.8,color="#4D4845")+
annotate(geom="text",label="ONT ARTIC",fontface='bold',x=500,y=-0.8,color="#4D4845")+
scale_size_continuous("Number of Samples")
novel
novel=novel%>%filter(sgRNA_count!=0)
novel=novel%>%filter(sgRNA_count!=0)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)+
scale_color_gradient("Number of Samples",low=navy,high=coral)+
annotate(geom="text",label="Illumina Metgenomic",fontface='bold',x=500,y=0.8,color="#4D4845")+
annotate(geom="text",label="ONT ARTIC",fontface='bold',x=500,y=-0.8,color="#4D4845")+
scale_size_continuous("Number of Samples")
novel
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)+
scale_color_gradient("Number of Samples",low=navy,high=coral)+
annotate(geom="text",label="Illumina Metgenomic",fontface='bold',x=500,y=0.8,color="#4D4845")+
annotate(geom="text",label="ONT ARTIC",fontface='bold',x=500,y=-0.8,color="#4D4845")+
scale_size_continuous("Number of Samples")+facet_grid(virus~line)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)+
scale_color_gradient("Number of Samples",low=navy,high=coral)+
annotate(geom="text",label="Illumina Metgenomic",fontface='bold',x=500,y=0.8,color="#4D4845")+
annotate(geom="text",label="ONT ARTIC",fontface='bold',x=500,y=-0.8,color="#4D4845")+
scale_size_continuous("Number of Samples")+facet_grid(time~line)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
theme(
axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.line.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)+
scale_color_gradient("Number of Samples",low=navy,high=coral)+
annotate(geom="text",label="Illumina Metgenomic",fontface='bold',x=500,y=0.8,color="#4D4845")+
annotate(geom="text",label="ONT ARTIC",fontface='bold',x=500,y=-0.8,color="#4D4845")+
scale_size_continuous("Number of Samples")
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta")%>%arrange(n),aes(x=pos,y=0.05,size=n,color=n))+
geom_point(alpha=0.8,data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),aes(x=pos,y=-0.05,size=n,color=n))+
scale_y_continuous(limits = c(-1,1))
head(novel)
novel=novel%>%filter(sgRNA_count!=0)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")+
annotate(geom="rect",xmin=200,xmax=13483,ymin=-0.05,ymax=0.05,color="grey50",fill="grey50")+
annotate(geom="text",x=7000,y=0,color="white",label="ORF1a",fontface='bold')+
annotate(geom="rect",xmin=13483,xmax=30000,ymin=-0.05,ymax=0.05,color="grey60",fill="grey60")+
annotate(geom="text",x=17000,y=0,color="white",label="ORF1b",fontface='bold')+
annotate(geom="rect",xmin=21532,xmax=30000,ymin=-0.05,ymax=0.05,color=navy,fill=navy)+
annotate(geom="text",x=23500,y=0,color="white",label="S",fontface='bold')+
annotate(geom="rect",xmin=25361,xmax=30000,ymin=-0.05,ymax=0.05,color=coral,fill=coral)+
annotate(geom="text",x=25750,y=0,color="white",label="3a",fontface='bold')+
annotate(geom="rect",xmin=26213,xmax=30000,ymin=-0.05,ymax=0.05,color=green,fill=green)+
annotate(geom="rect",xmin=26449,xmax=30000,ymin=-0.05,ymax=0.05,color=purple,fill=purple)+
annotate(geom="text",x=26700,y=0,color="white",label="M",fontface='bold')+
annotate(geom="rect",xmin=27017,xmax=30000,ymin=-0.05,ymax=0.05,color=yellow,fill=yellow)+
annotate(geom="rect",xmin=27364,xmax=30000,ymin=-0.05,ymax=0.05,color=orange,fill=orange)+
annotate(geom="rect",xmin=27864,xmax=30000,ymin=-0.05,ymax=0.05,color=grey,fill=grey)+
annotate(geom="rect",xmin=28235,xmax=30000,ymin=-0.05,ymax=0.05,color=aqua,fill=aqua)+
annotate(geom="text",x=28800,y=0,color="white",label="N",fontface='bold')+
annotate(geom="rect",xmin=29510,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,fill="white",alpha=0.3)+
scale_y_continuous(limits = c(-1,1))
novel=novel%>%filter(sgRNA_count!=0)
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")+
annotate(geom="rect",xmin=0,xmax=200,ymin=-0.05,ymax=0.05,color="grey30",fill="grey30")
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
scale_y_continuous(limits = c(-1,1))+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=0,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
scale_y_continuous(limits = c(-1,1))+
ft_theme()+
scale_x_continuous("Position")+
annotate(geom="rect",xmin=50,xmax=30000,ymin=-0.05,ymax=0.05,color="grey80",fill="grey80")
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
scale_y_continuous(limits = c(-1,1))+
ft_theme()+
scale_x_continuous("Position")
ggplot(mapping=aes(x=start,y=y,xend=pos,yend=y))+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="Illumina Meta"),lineend = "round",curvature=-0.3,color=grey,size=0.1)+
geom_curve(data=novel%>%group_by(start,y,class,pos,virus,line,time)%>%summarise(n=sum(sgRNA_count))%>%filter(n>1)%>%filter(class=="ONT ARTIC"),lineend = "round",curvature=0.3,color=grey,size=0.1)+
# geom_curve(data=interactions,curvature=-0.4,color=green)+
scale_alpha_continuous("Number of Samples")+
scale_y_continuous(limits = c(-1,1))+
ft_theme()+
scale_x_continuous("Position"
)
head(novel)
